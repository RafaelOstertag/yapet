<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
	  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"
[
<!ENTITY cpr SYSTEM "copyright.sgml">
<!ENTITY supplatforms SYSTEM "supportedplatforms.sgml">
<!ENTITY pwrecord SYSTEM "pwrecord.sgml">
<!ENTITY caution SYSTEM "caution.sgml">
<!ENTITY license SYSTEM "license.sgml">
<!ENTITY bugreport SYSTEM "bugreport.sgml">
<!ENTITY OPENSSL "<citerefentry><refentrytitle>ssl</refentrytitle>
<manvolnum>3</manvolnum></citerefentry>">
<!ENTITY CRYPTO "<citerefentry><refentrytitle>crypto</refentrytitle>
<manvolnum>3</manvolnum></citerefentry>">
<!ENTITY CURSES "<citerefentry><refentrytitle>curses</refentrytitle>
<manvolnum>3X</manvolnum></citerefentry>">
<!ENTITY YP "@PACKAGE_NAME@">
<!ENTITY yp "<command>@PACKAGE@</command>">
<!ENTITY ypman "<citerefentry><refentrytitle>yapet</refentrytitle>
<manvolnum>1</manvolnum></citerefentry>">
<!ENTITY CSV2YAPET "csv2yapet">
<!ENTITY csv2yapet "<command>csv2yapet</command>">
<!ENTITY csv2yapetman ", <citerefentry condition='csv2yapet'><refentrytitle>csv2yapet</refentrytitle>
<manvolnum>1</manvolnum></citerefentry>">
<!ENTITY YAPET2CSV "yapet2csv">
<!ENTITY yapet2csv "<command>yapet2csv</command>">
<!ENTITY yapet2csvman ", <citerefentry condition='yapet2csv'><refentrytitle>yapet2csv</refentrytitle>
<manvolnum>1</manvolnum></citerefentry>">
<!ENTITY FREEBSD "<trademark class='registered'>FreeBSD</trademark>">
<!ENTITY SOLARIS "<trademark class='trademark'>Sun</trademark>
<trademark class='trademark'>Solaris</trademark>">
<!ENTITY YPPKG "@PACKAGE_TARNAME@-@PACKAGE_VERSION@.tar.gz">
<!ENTITY YPVER "@PACKAGE_VERSION@">
]>
<refentry id="csv2yapet">
  <!-- $Id$ -->

  <refentryinfo>
     <productname>csv2yapet</productname>
     &cpr;
  </refentryinfo>

  <refmeta>
    <refentrytitle>csv2yapet</refentrytitle>
    <manvolnum>1</manvolnum>
    <refmiscinfo class="version">@PACKAGE_VERSION@</refmiscinfo>
    <refmiscinfo class="manual">User Commands</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>csv2yapet</refname>
    <refpurpose>convert CSV file to &YP; file</refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <cmdsynopsis cmdlength="9">
      &csv2yapet;
      <group>
	<arg choice="opt" rep="norepeat"><option>-c</option></arg>
	<arg choice="opt" rep="norepeat"><option>-h</option></arg>
	<arg choice="opt" rep="norepeat"><option>-V</option></arg>
      </group>
      <arg choice="opt" rep="norepeat"><option>-p</option> <arg
      choice="req"><replaceable>password</replaceable></arg></arg>
      <arg choice="opt" rep="norepeat"><option>-q</option></arg>
      <arg choice="opt" rep="norepeat"><option>-s</option> <arg choice="req"
      rep="norepeat"><replaceable>separator</replaceable></arg></arg>

      <arg choice="req"><replaceable>src</replaceable></arg>
      <arg choice="req"><replaceable>dst</replaceable></arg>
    </cmdsynopsis>
  </refsynopsisdiv>

  <!--
  -
  -  DESCRIPTION
  -
  -->
  <refsect1 id="description">
    <title>DESCRIPTION</title>

    <para>The &csv2yapet; utility converts a CSV file
    <replaceable>src</replaceable> to an &YP; file
    <replaceable>dst</replaceable>. The expected columns and column order of
    the CSV file is explained in <xref linkend="sourcefileformat" />.</para>

    <para>For each successfully imported source file record a corresponding
    &YP; password record will be generated in the resulting file.</para>

    <para>After the successful conversion the file
    <replaceable>dst</replaceable> can be opened with &ypman;.</para>

    <para>The file suffix <filename>.pet</filename> is appended to the output
    file <replaceable>dst</replaceable> if not provided as part of the file
    path.</para>

    <para>The password either entered on the standard input or provided as
    command line argument using the <option>-p</option> option is used to
    encrypt the destination file <replaceable>dst</replaceable> and must be
    used to decrypt the file content when opening the file in &ypman;.</para>

    <para>&csv2yapet; will not overwrite existing destination files. If the
    destination file already exists &csv2yapet; will abort the
    conversion.</para>

    <para>Errors during the conversion process will be displayed unless the
    <option>-q</option> option is provided.</para>

    <!--
	-
	- SOURCE FILE FORMAT
	-
    -->
    <refsect2 id="sourcefileformat">
      <title>Source File Format</title>

      <para>The source file <replaceable>src</replaceable> to be converted has
      to be organized as CSV file. The default character for delimiting the
      fields is ',' (comma) unless specified differently on the command line
      providing the <option>-s</option> option (refer to <xref
      linkend="options" />).</para>

      <para>Fields containing the field separator character have to be enclosed
      in double quotes (").</para>

      <para>Double quote characters to be converted literally, has each to be
      preceded by another double quote character (see <xref linkend="examples"
      />).</para>

      <para>The following table will describe the fields of the source CSV file
      as expected by &csv2yapet;:</para>

      <table pgwide="1">
	<title>Source file format</title>

	<tgroup cols="2">
	  <colspec colname="colnum" align="center" />
	  <colspec colname="desc" align="left" />

	  <thead>
	    <row>
	      <entry>Column #</entry>
	      <entry align="left">&YP; record field</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry>1</entry>
	      <entry align="left">Name</entry>
	    </row>

	    <row>
	      <entry>2</entry>
	      <entry>Host</entry>
	    </row>

	    <row>
	    <entry>3</entry>
	    <entry>Username</entry>
	    </row>

	    <row>
	    <entry>4</entry>
	    <entry>Password</entry>
	    </row>

	  <row>
	    <entry>5</entry>
	    <entry>Comment</entry>
	  </row>
	  </tbody>
	</tgroup>
      </table>

      <para>See <xref linkend="examples" /> for an example CSV file.</para>

    </refsect2>
  </refsect1>

  <!--
  -
  -  OPTIONS
  -
  -->
  <refsect1 id="options">
    <title>OPTIONS</title>

    <para>The following options are supported:</para>

    <variablelist>
      <varlistentry>
	<term><option>-c</option></term>
	<listitem>
	  <para>Show the copyright information.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><option>-h</option></term>
	<listitem>

	  <para>Print a help text.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><option>-p</option> <replaceable>password</replaceable></term>

	<listitem>
	  <para>The password to be used to encrypt the &YP; file. If
	  &csv2yapet; is invoked without this option, it will prompt for the
	  password on the standard input.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><option>-q</option></term>

	<listitem>
	  <para>Enable the quiet mode. No details about errors are reported.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><option>-s</option> <replaceable>separator</replaceable></term>

	<listitem>

	  <para>
	    Change the default field separator ',' (comma) to the single
	    character <replaceable>separator</replaceable>.
	  </para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><option>-V</option></term>
	<listitem>

	  <para>Show the version of &csv2yapet;.</para>
	</listitem>
      </varlistentry>

    </variablelist>
  </refsect1>

  <!--
  -
  -  OPERANDS
  -
  -->
  <refsect1 id="operands">
    <title>OPERANDS</title>

    <para>The following operands are required:</para>

    <variablelist>
      <varlistentry>
	<term><replaceable>src</replaceable></term>

	<listitem>
	  <para>The source CSV file to be converted. It must be of the format
	  described in <xref linkend="sourcefileformat" />.</para>

	</listitem>
      </varlistentry>

      <varlistentry>
	<term><replaceable>dst</replaceable></term>

	<listitem>
	  <para>The resulting &YP; file holding the content of
	  <replaceable>src</replaceable> encrypted. This file must not exist
	  prior the conversion process, else &csv2yapet; will not start the
	  conversion and abort.</para>

	</listitem>
      </varlistentry>

    </variablelist>
  </refsect1>


  <!--
  -
  - EXAMPLES
  -
  -->

  <refsect1 id="examples">
    <title>EXAMPLES</title>

    <example id="ex.csv1">
      <title>An example of a CSV file accepted by &csv2yapet;.</title>

      <para>The following example shows an excerpt of a CSV file as accepted
      for conversion by &csv2yapet;.</para>

      <para>As the second line shows, fields can be blank but the separator may
      not be omitted.</para>
<screen>
ssh host,host.example.org,johndoe,secret,Linux machine
mail account,imap.email.org,john_doe,secret,
&hellip;
</screen>
    </example>

    <example id="ex.csv2">
      <title>An example of a CSV file accepted by &csv2yapet; using double quotes.</title>

      <para>The following example shows an excerpt of a CSV file as accepted
      for conversion by &csv2yapet;.</para>

      <para>The first line demonstrates how to double quote fields containing
      the separator character. The second line shows how to literally convert
      double quote characters.</para>

<screen>
"ssh, ftp, and http server",server.example.org,johndoe,secret,Linux machine
mail account,imap.email.org,john_doe,secret,"John ""the Unknown"" Doe"
&hellip;
</screen>
    </example>

    <example id="ex.invoc1">
      <title>Invoking &csv2yapet;.</title>

      <para>The following example shows how to invoke &csv2yapet; in order to
      convert a CSV file to an &YP; file. If the <option>-s</option> option is
      not given, &csv2yapet; will ask for a password as shown:</para>

<screen>
<prompt>$</prompt> &csv2yapet; <filename>passwords.csv</filename> <filename>passwords.pet</filename>
Please enter the password for passwords.pet:
Please re-type the password:

passwords.pet successfully created.
$
</screen>
    </example>

  </refsect1>

  <!--
      -
      - EXIT STATUS
      -
  -->
  <refsect1 id="exitstatus">
    <title>EXIST STATUS</title>

    <para>
      <variablelist>

	<varlistentry>
	  <term><returnvalue>0</returnvalue></term>

	  <listitem>
	    <para>No error.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><returnvalue>1</returnvalue></term>

	  <listitem>
	    <para>Wrong command line arguments provided.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><returnvalue>2</returnvalue></term>

	  <listitem>
	    <para>The passwords provided on the standard input do not match.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><returnvalue>3</returnvalue></term>

	  <listitem>
	    <para>The destination file
	    <filename><replaceable>dst</replaceable></filename> already exists.
	    </para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><returnvalue>4</returnvalue></term>

	  <listitem>
	    <para>An unexpected error occurred.
	    </para>
	  </listitem>
	</varlistentry>

      </variablelist>
    </para>

  </refsect1>

  <!--
  -
  -  BUGS
  -
  -->
  <refsect1 id="bugs">
    <title>BUGS</title>

    &bugreport;
  </refsect1>


  <!--
  -
  -  AUTHOR
  -
  -->
  <refsect1 id="author">
    <title>AUTHOR</title>
    <simpara>Rafael Ostertag <email>rafi@guengel.ch</email></simpara>
  </refsect1>

  <!--
  -
  -  SEE ALSO
  -
  -->
  <refsect1 id="seealso">
    <title>SEE ALSO</title>

    <simpara>&ypman;</simpara>
  </refsect1>

  <!--
      -
      - LICENSE
      -
  -->
  <refsect1 id="license">
    <title>LICENSE</title>

    <para>&CSV2YAPET; is part of &YP;.</para>

    &license;
  </refsect1>

</refentry>
